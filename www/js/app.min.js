function Config(a,b,c){Parse.initialize("mZDlpzWNmOc9ZWGuxWTZAgl2UcorL2JxwdB6RG48","YygfF1qpxWlma7ab6WytNFOMjWl1vWV1fs8yLRMi"),a.state("about",{url:"/about",templateUrl:"views/about.html"}).state("contact",{url:"/contact",templateUrl:"views/contact.html"}).state("help",{url:"/help",templateUrl:"views/help.html"}).state("withTabs",{url:"/main","abstract":!0,templateUrl:"views/tabs.html"}).state("withTabs.productsAgriculture",{url:"/products-agriculture",views:{content:{controller:"ProductsController",templateUrl:"views/products.html"}}}).state("withTabs.productsWholesale",{url:"/products-wholesale",views:{content:{controller:"ProductsController",templateUrl:"views/products.html"}}}).state("withTabs.chart",{url:"/chart",views:{content:{templateUrl:"views/chart.html"}}}),b.otherwise("/main/products-agriculture"),c.tabs.style("standard"),c.tabs.position("bottom")}function Run(a,b,c,d,e,f,g){b.ready(function(){})}function MainController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){console.log("MainController"),b.isTabActive=function(b){return console.log("-------------isTabActive"),a.path().indexOf(b)>-1},b.isItemActive=function(b){return a.path().indexOf(b)>-1}}function JobsUserController(a,b,c,d,e,f,g,h){b.position={},b.setCurrentPosition=function(){return e.ready(function(){return d.getCurrentPosition({timeout:1e4,enableHighAccuracy:!0}).then(function(a){angular.isUndefined(a)||angular.isUndefined(a.coords)||angular.isUndefined(a.coords.latitude)||angular.isUndefined(a.coords.longitude)?b.position={}:(b.position.geo_point_lat=a.coords.latitude,b.position.geo_point_lon=a.coords.longitude)},function(a){b.position={}})})},b.init=function(a){angular.isUndefined(a)&&(a=!1),b.jobs=[],b.loaded=!1,b.error=!1,b.nextCurs="",b.noMoreJobsAvailable=!1,b.position={},b.user.logged&&(a||b.getMyJobs(),b.setCurrentPosition().then(function(){a?b.getMyJobs(!1,!0):angular.isUndefined(b.position.geo_point_lat)||angular.isUndefined(b.position.geo_point_lon)||b.getMyJobs()},function(){a&&b.getMyJobs(!1,!0)}))},b.getMyJobs=function(a,d){angular.isUndefined(a)?a=!1:angular.isUndefined(d)&&(d=!1);var e;a?e=c.getFeed(b.nextCurs,b.position,!0):(d?(b.loaded=!1,b.noMoreJobsAvailable=!1):f.show(),e=c.getFeed(!1,b.position,!0)),e.then(function(c){var e=[];b.nextCurs=c.nextCurs,angular.isUndefined(b.nextCurs)&&(b.noMoreJobsAvailable=!0),angular.forEach(c.jobs,function(a,b){angular.isUndefined(a.employment_status)||"CANCELED"==a.employment_status||"UNLIKED"==a.employment_status||e.push(a)}),a?(b.jobs=b.jobs.concat(e),b.$broadcast("scroll.infiniteScrollComplete")):(b.jobs=e,b.loaded=!0,d||f.hide(),d&&b.$broadcast("scroll.refreshComplete"))},function(c){b.error=!0,a||d?d?b.$broadcast("scroll.refreshComplete"):b.$broadcast("scroll.infiniteScrollComplete"):f.hide()})},b.goToJob=function(a,b){b.preventDefault(),g.go("employees.jobsFeed"),h(function(){g.go("employees.job",{jobId:a})},0)},b.refreshMyJobs=function(){b.init(!0)},b.loginAndRefresh=function(){b.login().then(function(a){a&&b.init()})},a.$on("$stateChangeStart",function(a,c,d,e,f){"employees.jobsUser"==c.name&&b.init()}),b.init()}function JobsSearchController(a,b,c,d,e,f){var g={};a.setCurrentPosition=function(){return d.ready(function(){return c.getCurrentPosition({timeout:1e4,enableHighAccuracy:!0}).then(function(a){angular.isUndefined(a)||angular.isUndefined(a.coords)||angular.isUndefined(a.coords.latitude)||angular.isUndefined(a.coords.longitude)?g={}:(g.geo_point_lat=a.coords.latitude,g.geo_point_lon=a.coords.longitude)},function(a){g={}})})},a.init=function(){g={},a.jobs=[],a.loaded=!1,a.error=!1,a.setCurrentPosition().then(function(){a.getFeed()},function(){a.getFeed()})},a.isSearching=!1,a.searchData={employer_title:"",position:"",address:"",open_query:""},a.$watch("searchData",function(b){a.error=!1;var c=!0;angular.forEach(b,function(a,b){a&&(c=!1)}),c?(a.loaded=!1,a.isSearching=!1):(angular.isUndefined(a.typingTimeout)||f.cancel(a.typingTimeout),a.typingTimeout=f(function(){a.jobs=[],a.loaded=!1,a.noMoreJobsAvailable=!1,a.isSearching=!0,a.init()},500))},!0),a.getFeed=function(c){angular.isUndefined(c)&&(c=!1),angular.isUndefined(g.geo_point_lat)||angular.isUndefined(g.geo_point_lon)?(delete a.searchData.geo_point_lat,delete a.searchData.geo_point_lon):angular.extend(a.searchData,g);var d;d=c?b.getFeed(a.nextCurs,a.searchData):b.getFeed(!1,a.searchData),d.then(function(b){a.nextCurs=b.nextCurs,angular.isUndefined(a.nextCurs)&&(a.noMoreJobsAvailable=!0),c?(a.jobs=a.jobs.concat(b.jobs),a.$broadcast("scroll.infiniteScrollComplete")):(a.jobs=b.jobs,a.loaded=!0)},function(b){a.error=!0,c&&a.$broadcast("scroll.infiniteScrollComplete")})},a.goToJob=function(a,b){b.preventDefault(),e.go("employees.jobsFeed"),f(function(){e.go("employees.job",{jobId:a})},0)}}function ProductsController(a,b,c,d,e,f,g,h,i,j,k){console.log("ProductsController"),a.viewClassName="two-per-row",a.changeView=function(){return a.viewClassName="two-per-row"==a.viewClassName?"":"two-per-row",!1};var l,m={};a.showDetailsPopup=function(b){l=e.show({templateUrl:"views/list/details-popup.html",cssClass:"details",scope:a})},a.closeDetailsPopup=function(){l.close()};var n;a.showPushNotificationPopup=function(b){a.pushNotificationPercent=b.percent,a.pushNotificationEnabled=Boolean(b.percent),a.itemTitleForPushNotificationPopup=b.name,a.itemForPushNotificationPopup=b,n=e.show({templateUrl:"views/list/push-popup.html",cssClass:"push-notification",scope:a})},a.closePushNotificationPopup=function(){n.close()},a.setPushNotificationPercent=function(b,c,d){if(b.percent&&m[b.id]&&m[b.id].destroy(),c){var e=Parse.Object.extend("product_notify"),f=new e;f.set("productID",b.id),f.set("percent",parseInt(d)),f.save(null,function(a){m[b.id]=a})}b.percent=c?d:null,a.closePushNotificationPopup()};var o;a.showFilterPopup=function(){a.typeFilter=a.filterType,a.orderFilter=a.filterOrder,o=e.show({templateUrl:"views/list/filter-popup.html",cssClass:"list-filter",scope:a})},a.closeFilterPopup=function(){o.close()},a.setFilters=function(b,c){console.log(b,c),f.items=[],a.filterOrder=b,a.filterType=c,o.close()};var p;a.showDatePopup=function(){a.dateFilter=new Date(d("date")(a.filterDate,"yyyy-MM-dd")),p=e.show({templateUrl:"views/list/date-popup.html",cssClass:"date-filter",scope:a})},a.closeDatePopup=function(){p.close()},a.setDate=function(b){console.log("--date--",b),f.items=[],a.filterDate=d("date")(b,"yyyy-MM-dd"),p.close()},f.shareProduct=function(a){console.log("share"),c.share("פריסייל - "+a.name)},a.setListDetails=function(b){a.listDetails=b,a.closeDetailsPopup()},a.userType="wholesale",a.listDetails="price",a.setUserType=function(b){a.userType=b},f.topQualityPrice=function(a){return a.topQuality[f.userType].price},f.primeQualityPrice=function(a){return a.primeQuality[f.userType].price},f.topQualityAvgPrice=function(a){return a.topQuality[f.userType].weeklyAvg},f.primeQualityAvgPrice=function(a){return a.primeQuality[f.userType].weeklyAvg},f.topQualityPercentChange=function(a){return a.topQuality[f.userType].percentChange},f.primeQualityPercentChange=function(a){return a.primeQuality[f.userType].percentChange},a.items=[],a.filterName=void 0,a.filterDate=d("date")(new Date,"yyyy-MM-dd"),a.filterType="",a.filterOrder="DAILY_CHANGE",a.filterSort=void 0,a.filterPage=void 0;var q=!1;a.loadMore=function(){console.log("loadMore");console.log("using parse1");var a=Parse.Object.extend("product_notify"),b=new Parse.Query(a);b.find({success:function(a){for(var b=0;b<a.length;b++)m[a[b].get("productID")]=a[b];for(var b=0;50>b;b++)f.items.push({name:"tomato",id:12,percent:m[12]?m[12].get("percent"):null,topQuality:{wholesale:{price:4.3,percentChange:20,weeklyAvg:5},agriculture:{price:2.3,percentChange:20,weeklyAvg:5}},primeQuality:{wholesale:{price:4.2,percentChange:20,weeklyAvg:5},agriculture:{price:2.2,percentChange:20,weeklyAvg:5}}})}})},f.$on("$stateChangeSuccess",function(){f.loadMore()}),f.moreDataCanBeLoaded=function(){return!q},f.showNameFilter=function(){},f.itemClicked=function(a){console.log("item clicked:",a)}}function JobController(a,b,c,d,e,f,g,h){a.employer=!1,a.job=!1,a.employee=!1,a.init=function(){return a.loaded=!1,a.error=!1,a.getJob()},a.getJob=function(){return f.show(),b.getJob(g.jobId).then(function(b){a.employer=b.employer,a.job=b.job,angular.isUndefined(b.employee.status)?a.employee={}:a.employee=b.employee,angular.isUndefined(a.employer.geo_point_lat)||angular.isUndefined(a.employer.geo_point_lon)||(a.map={center:{latitude:a.employer.geo_point_lat,longitude:a.employer.geo_point_lon},zoom:12},a.marker={id:0,cords:{latitude:a.employer.geo_point_lat,longitude:a.employer.geo_point_lon},options:{labelContent:a.employer.title}}),a.loaded=!0,f.hide()},function(b){a.error=!0,f.hide()})};var i=function(a,b){return d.alert(b,a,"המשך")},j=function(a,b,c){return angular.isUndefined(c)&&(c=["אישור","ביטול"]),d.confirm(b,a,c)};a.applyJob=function(){a.user.logged?(f.show(),b.applyJob(a.job.id).then(function(b){a.employee={id:b.employment_urlsafe_key,status:b.status},f.hide(),e.showShortBottom("הבקשה הוגשה בהצלחה")},function(){f.hide(),i("איראה שגיאה","אירעה שגיאה במהלך הגשת מועמדות למשרה, אנא נסה שנית")})):a.login("apply").then(function(b){b&&a.init().then(function(){(angular.isUndefined(a.employee.status)||"APPLICANT"!=a.employee.status&&"AWAITING_FINAL_APPROVAL"!=a.employee.status&&"EMPLOYEE"!=a.employee.status)&&a.applyJob()})})},a.finalApplyJob=function(){f.show(),b.finalApplyJob(a.employee.id).then(function(b){a.employee={id:b.employment_urlsafe_key,status:b.status},f.hide(),e.showShortBottom("אישרת התחלת עבודה במשרה")},function(){f.hide(),i("איראה שגיאה","אירעה שגיאה במהלך אישור התחלת עבודה, אנא נסה שנית")})},a.resignFromJob=function(){j("התפטרות","האם אתה בטוח שאתה רוצה להתפטר ממשרה זו?").then(function(c){1==c&&(f.show(),b.resignFromJob(a.employee.id).then(function(b){a.employee={id:b.employment_urlsafe_key,status:b.status},f.hide(),e.showShortBottom("התפטרת מהמשרה")},function(){f.hide(),i("איראה שגיאה","אירעה שגיאה במהלך התפטרות ממשרה, אנא נסה שנית")}))})},a.cancelApplicationJob=function(){j("ביטול מועמדות למשרה","האם אתה בטוח שאתה רוצה לבטל מועמדות למשרה?").then(function(c){1==c&&(f.show(),b.cancelApplicationJob(a.employee.id).then(function(b){a.employee={id:b.employment_urlsafe_key,status:b.status},f.hide(),e.showShortBottom("הבקשה בוטלה")},function(){f.hide(),i("איראה שגיאה","אירעה שגיאה במהלך ביטול מועמדות למשרה, אנא נסה שנית")}))})},a.likeButtonClick=function(){a.user.logged?angular.isUndefined(a.employee.status)||"UNLIKED"==a.employee.status?a.likeJob():a.dislikeJob():a.login("like").then(function(b){b&&a.init().then(function(){(angular.isUndefined(a.employee.status)||"UNLIKED"==a.employee.status)&&a.likeJob()})})},a.likeJob=function(){f.show(),b.likeJob(a.job.id).then(function(b){a.employee.status="LIKED",f.hide(),e.showShortBottom("הוספת משרה למשרות שלי")},function(){f.hide(),i("איראה שגיאה","אירעה שגיאה במהלך הוספת המשרה למשרות שלי, אנא נסה שנית")})},a.dislikeJob=function(){f.show(),b.dislikeJob(a.job.id).then(function(b){a.employee.status="UNLIKED",f.hide(),e.showShortBottom("הסרת משרה מהמשרות שלי")},function(){i("איראה שגיאה","אירעה שגיאה במהלך מחיקת המשרה מהמשרות שלי, אנא נסה שנית")})},a.shareJob=function(){c.share("היי! דרושים "+a.job.position+" ל- "+a.employer.title+". לחץ כאן כדי להגיש מועמדות",!1,!1,"http://www.jobhop.co.il/jobs/"+a.job.id)},a.openNavigator=function(){e.showShortBottom("פותח אפליקציית ניווט..."),launchnavigator.navigate(a.employer.address+", ישראל","",function(){},function(a){i("איראה שגיאה","אירעה שגיאה במהלך פתיחת אפליקציית הניווט, אנא נסה שנית")})},a.init()}function JobEmployerController(a,b,c,d,e){a.employer=!1,a.employment=!1,a.loaded=!1,a.error=!1,a.init=function(){a.getEmployer().then(function(){""!=e.employmentId&&a.getEmployment()})},a.getEmployer=function(){return d.show(),b.getEmployer(e.employerId).then(function(b){a.employer=b,angular.isUndefined(a.employer.geo_point_lat)||angular.isUndefined(a.employer.geo_point_lon)||(a.map={center:{latitude:a.employer.geo_point_lat,longitude:a.employer.geo_point_lon},zoom:12},a.marker={id:0,cords:{latitude:a.employer.geo_point_lat,longitude:a.employer.geo_point_lon},options:{labelContent:a.employer.title}}),a.loaded=!0,d.hide()},function(b){a.error=!0,d.hide()})},a.getEmployment=function(){return d.show(),b.getEmployment(e.employmentId).then(function(b){a.employment=b,a.loaded=!0,d.hide()},function(b){a.error=!0,d.hide()})},a.openNavigator=function(){c.showShortBottom("פותח אפליקציית ניווט..."),launchnavigator.navigate(a.employer.address+", ישראל","",function(){},function(a){showPopup("איראה שגיאה","אירעה שגיאה במהלך פתיחת אפליקציית הניווט, אנא נסה שנית")})},a.init()}function UserProfileController(a,b){a.profile_video_uri=!1,angular.isUndefined(a.user.profile.profile_video_uri)||(a.profile_video_uri=b.trustAsResourceUrl(a.user.profile.profile_video_uri)),a.$watch("user.profile.profile_video_uri",function(c){angular.isUndefined(c)||""==c?a.profile_video_uri=!1:a.profile_video_uri=b.trustAsResourceUrl(a.user.profile.profile_video_uri)})}function UserProfileEditController(a,b,c,d,e,f,g){a.profileImage={original:a.user.profile.profile_image_uri||"img/no-thumb.gif",data:a.user.profile.profile_image_uri||"img/no-thumb.gif"};var h=angular.copy(a.user.profile);angular.isUndefined(h.birth_date)?h.birth_date=new Date:h.birth_date=new Date(h.birth_date),a.profileEdit={form:"",data:h},console.log(a.profileEdit.data.birth_date),a.enums={genders:[{label:"זכר",value:"MALE"},{label:"נקבה",value:"FEMALE"}]},a.chooseImage=function(){c.getPicture({quality:100,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.SAVEDPHOTOALBUM,allowEdit:!0,encodingType:Camera.EncodingType.JPEG,targetWidth:800,targetHeight:800,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!0}).then(function(b){a.profileImage.data="data:image/jpeg;base64,"+b})};var i=function(a){return a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2)};a.minDate=new Date("01/01/1960"),a.maxDate=new Date,a.maxDate.setTime(a.maxDate.valueOf()-31536e7),a.minDate=i(a.minDate),a.maxDate=i(a.maxDate);var j=function(a,b){return d.alert(message,a,"המשך")},k=function(a){return"function"==typeof a.getMonth?a.getUTCFullYear()+"-"+l(a.getUTCMonth()+1)+"-"+l(a.getUTCDate())+"T"+l(a.getUTCHours())+":"+l(a.getUTCMinutes())+":"+l(a.getUTCSeconds())+"Z":a},l=function(a){return 10>a?"0"+a:a};a.submit=function(c){if(angular.isUndefined(c)&&(imageUpload=!1),c){var d=angular.copy(a.profileEdit.data);d.birth_date=k(d.birth_date),b.editUserProfile(d).then(function(){f.hide(),e.showShortBottom("העריכה בוצעה בהצלחה"),g.go("employees.profile")},function(a){f.hide(),j("אירעה שגיאה","אירעה שגיאה בתקשורת עם המערכת")})}else f.show(),a.profileEdit.form.$valid&&(a.profileImage.data!=a.profileImage.original?b.uploadImage(a.profileImage.data).then(function(b){a.profileEdit.data.profile_image_uri=b,a.submit(!0)},function(){j("אירעה שגיאה","אירעה שגיאה בתקשורת עם המערכת")}):a.submit(!0))}}function RegisterController(a,b,c,d,e,f,g,h,i,j){a.profileImage={"default":"img/no-thumb.gif",data:"img/no-thumb.gif"},a.register={form:"",data:{first_name:"",last_name:"",description:"",address:"",phone_number:"",birth_date:new Date,gender:"",profile_image_uri:""}},a.getUserProfileData=function(){f.show({delay:100}),d.api("/me").then(function(b){a.profileImage["default"]="https://graph.facebook.com/"+b.id+"/picture?type=large",a.profileImage.data=a.profileImage["default"],a.register.data.first_name=b.first_name,a.register.data.last_name=b.last_name,angular.isUndefined(b.gender)||"male"!=b.gender&&"female"!=b.gender||(a.register.data.gender=b.gender.toUpperCase()),angular.isUndefined(b.birthday)||(a.register.data.birth_date=new Date(b.birthday)),f.hide()},function(){f.hide()})},a.init=function(){a.getUserProfileData()},a.enums={genders:[{label:"זכר",value:"MALE"},{label:"נקבה",value:"FEMALE"}]},a.chooseImage=function(){c.getPicture({quality:100,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.SAVEDPHOTOALBUM,allowEdit:!0,encodingType:Camera.EncodingType.JPEG,targetWidth:800,targetHeight:800,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!0}).then(function(b){a.profileImage.data="data:image/jpeg;base64,"+b})};var k=function(a){return a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2)};a.minDate=new Date("01/01/1960"),a.maxDate=new Date,a.maxDate.setTime(a.maxDate.valueOf()-31536e7),a.minDate=k(a.minDate),a.maxDate=k(a.maxDate);var l=function(a,b){return e.alert(b,a,"המשך")},m=function(a){return"function"==typeof a.getMonth?a.getUTCFullYear()+"-"+n(a.getUTCMonth()+1)+"-"+n(a.getUTCDate())+"T"+n(a.getUTCHours())+":"+n(a.getUTCMinutes())+":"+n(a.getUTCSeconds())+"Z":a},n=function(a){return 10>a?"0"+a:a};a.submit=function(c){if(angular.isUndefined(c)&&(imageUpload=!1),c){var d=angular.copy(a.register.data);d.birth_date=m(d.birth_date),b.register("FACEBOOK",d).then(function(){if(!(angular.isUndefined(g.jobId)||""==g.jobId||angular.isUndefined(g.action)||"apply"!=g.action&&"apply"!=g.action)){var a=g.jobId,c=g.action;h.goBack(-2),"apply"==c?b.applyJob(a).then(function(){f.hide(),l("ההרשמה בוצעה בהצלחה","נרשמת בהצלחה ל-JobHop! הינך מועבר לדף משרות").then(function(){i.go("employees.jobsFeed"),j(function(){i.go("employees.profile",{scrollToVideo:!0})},0)})}):b.likeJob(a).then(function(){f.hide(),l("ההרשמה בוצעה בהצלחה","נרשמת בהצלחה ל-JobHop! הינך מועבר לדף משרות").then(function(){i.go("employees.jobsFeed"),j(function(){i.go("employees.profile",{scrollToVideo:!0})},0)})})}},function(a){f.hide(),409==a.code?l("אימייל תפוס","כתובת אימייל זו תפוסה"):l("אירעה שגיאה","אירעה שגיאה בתקשורת עם המערכת")})}else f.show(),a.register.form.$valid&&(a.profileImage.data!=a.profileImage["default"]?b.uploadImage(a.profileImage.data).then(function(b){a.register.data.profile_image_uri=b,a.submit(!0)},function(){l("אירעה שגיאה","אירעה שגיאה בתקשורת עם המערכת")}):(a.register.data.profile_image_uri=a.profileImage.data,a.submit(!0)))},a.init()}function jobBlock(){return{restrict:"E",scope:{job:"=",link:"=",employer:"=",employee:"="},templateUrl:"views/employees/job-template.html",link:function(a,b,c){}}}function hideTabs(){return{restrict:"A",link:function(a,b,c){a.$root.hideTabs="tabs-item-hide",a.$on("$destroy",function(){a.$root.hideTabs=""})}}}function JobHopAPI(a,b,c,d,e,f,g){var h={},i=function(){for(var a=32,b="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",c="",d=a;d>0;--d)c+=b[Math.round(Math.random()*(b.length-1))];return c},j=function(){var a=new Date(c.user.profile.birth_date),b=Date.now()-a.getTime(),d=new Date(b);c.user.profile.age=Math.abs(d.getUTCFullYear()-1970)};h.uploadImage=function(a){var b=f.defer(),c="-------314159265358979323846",d="\r\n--"+c+"\r\n",e="\r\n--"+c+"--",h=a.split(",")[0].split(":")[1].split(";")[0],j=a.split(",")[1],k="user/images/",l={name:k+i(),mimeType:h},m=d+"Content-Type: application/json\r\n\r\n"+angular.toJson(l)+d+"Content-Type: "+h+"\r\nContent-Transfer-Encoding: base64\r\n\r\n"+j+e,n="v1",o="jobhopapp.appspot.com",p=g.gapi.client.request({path:"/upload/storage/"+n+"/b/"+o+"/o",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="'+c+'"'},body:m});return p.execute(function(a){b.resolve("https://storage.googleapis.com/jobhopapp.appspot.com/"+a.name)},function(){b.reject()}),b.promise},h.uploadVideo=function(a){var b="user/videos/"+i(),c="https://www.googleapis.com/",d="storage/v1",f="jobhopapp.appspot.com",g="upload/"+d+"/b/"+f+"/o?uploadType=media&name="+b;return e.upload(c+g,a.fullPath,{mimeType:a.type,fileName:b,headers:{"Accept-Encoding":"gzip","Content-Type":a.type,"Content-Length":a.size}}).then(function(a){var b="https://storage.googleapis.com/jobhopapp.appspot.com/"+angular.fromJson(a.response).name;return b})},h.getCurrentUserProfile=function(){var b={base_message:c.user.baseMessage};return a.execute("jobhopApi","user.get_current_user_profile",b).then(function(a){return delete a.result,a})},h.getCurrentUserProfileKey=function(){var b={base_message:c.user.baseMessage};return a.execute("jobhopApi","user.get_current_user_profile_key",b)},h.createUserProfile=function(b){var d={base_message:c.user.baseMessage};return angular.extend(d,b),a.execute("jobhopApi","user.create_user_profile",d).then(function(a){delete a.result,c.user.profile=b,c.user.profile.id=a.urlsafe_key,j()})},h.editUserProfile=function(b){var d={base_message:c.user.baseMessage,user_message:b,user_urlsafe_key:b.id};return a.execute("jobhopApi","user.update_user",d).then(function(){c.user.profile=b,c.user.profile.id=b.id,j()})},h.updateProfileVideo=function(b){var d={base_message:c.user.baseMessage,user_urlsafe_key:c.user.profile.id,video_uri:b};return a.execute("jobhopApi","user.update_user_video_profile",d).then(function(){c.user.profile.profile_video_uri=b})},h.login=function(b,d,e){var f={auth_type:b,identifier:d.identifier,secret:d.secret},g=a.execute("jobhopApi","signin.sign_in",f);return!angular.isUndefined(e)&&e?g.then(function(a){c.user.baseMessage={auth_type:b,auth_id:a.auth_id,token:a.token}}):g.then(function(a){return c.user.account_key=a.account_key,c.user.baseMessage={auth_type:b,auth_id:a.auth_id,token:a.token},angular.isUndefined(a.complete_user_message)?!1:h.getCurrentUserProfile().then(function(a){return h.getCurrentUserProfileKey().then(function(b){return c.user.profile=a,c.user.profile.id=b.urlsafe_key,c.user.logged=!0,j(),!0},function(a){return c.user.baseMessage={},a})},function(a){return c.user.baseMessage={},a})})},h.register=function(a,b){var d=({auth_type:a,identifier:b.identifier,secret:b.secret},{});return angular.extend(d,b),h.createUserProfile(d).then(function(){c.user.logged=!0,c.user=c.user})},h.logout=function(){return c.user={profile:{},baseMessage:{},logged:!1},d.logout()},h.getFeed=function(d,e,f){var g={njobs:b,fetch_type:"GENERAL",filter_message:{}};return!angular.isUndefined(f)&&f&&(g.fetch_type="ACCOUNT_EMPLOYMENT"),!angular.isUndefined(d)&&d&&(g.curs=d),!angular.isUndefined(e)&&e&&(g.filter_message=e),c.user.logged&&(g.base_message=c.user.baseMessage),a.execute("jobhopApi","feed.fetch",g).then(function(a){var b={nextCurs:a.next_curs,jobs:[]};return angular.forEach(a.feed_entries,function(a,c){var d=a.urlsafe_key;a.id=d,delete d,delete a.urlsafe_key,angular.isUndefined(e.geo_point_lat)||angular.isUndefined(e.geo_point_lon)||angular.isUndefined(a.employer_address_lat)||angular.isUndefined(a.employer_address_lon)?a.distance=-1:a.distance=h.getDistanceFromJob(e,a),b.jobs.push(a)}),b})};var k=function(a){return a*Math.PI/180};return h.getDistanceFromJob=function(a,b){var c=a.geo_point_lat,d=a.geo_point_lon,e=b.employer_address_lat,f=b.employer_address_lon,g=6371,h=c-e,i=k(h),j=d-f,l=k(j),m=Math.sin(i/2)*Math.sin(i/2)+Math.cos(k(e))*Math.cos(k(c))*Math.sin(l/2)*Math.sin(l/2),n=2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),o=g*n;return o=Math.round(10*o)/10},h.jobIsExist=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","job.get_job",d)},h.getJob=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","job.get_complete_job",d).then(function(a){var b=a.complete_employer_message,c=a,d={};d.id=b.employer_urlsafe_key,angular.extend(d,b.employer_message);var e={};e.id=c.job_urlsafe_key,angular.extend(e,c.job_message),angular.forEach([{label:"משמרות",value:"SHIFTS"},{label:"משרה חלקית",value:"PART_TIME"},{label:"משרה מלאה",value:"FULL_TIME"}],function(a){a.value==e.type&&(e.type=a.label)});var f={};return angular.isUndefined(c.employee_message)||(f.id=c.employee_message.employment_urlsafe_key,f.status=c.employee_message.status),{employer:d,job:e,employee:f}})},h.getEmployer=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","employer.get_complete_employer",d).then(function(a){var b={};return b.id=a.employer_urlsafe_key,angular.extend(b,a.employer_message),b})},h.getEmployment=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","employee.get_employee",d).then(function(a){var b={id:a.urlsafe_key,statu:a.status};return b})},h.applyJob=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","job.apply_to_job",d)},h.applyJobWithVideo=function(b,d){var e={job_key:b,video_message:{type:"PROFILE_VIDEO"}};return angular.isUndefined(d)||(e.video_message={type:"NEW_VIDEO",uri:d}),c.user.logged&&(e.base_message=c.user.baseMessage),a.execute("jobhopApi","job.apply_to_job_with_video",e)},h.finalApplyJob=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","job.final_approve_job",d)},h.resignFromJob=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","job.resign_from_job",d)},h.cancelApplicationJob=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","job.cancel_application",d)},h.likeJob=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","job.add_to_my_jobs",d)},h.dislikeJob=function(b){var d={urlsafe_key:b};return c.user.logged&&(d.base_message=c.user.baseMessage),a.execute("jobhopApi","job.remove_from_my_jobs",d)},h}function cut(){return function(a,b,c,d){if(!a)return"";if(c=parseInt(c,10),!c)return a;if(a.length<=c)return a;if(a=a.substr(0,c),b){var e=a.lastIndexOf(" ");-1!=e&&(a=a.substr(0,e))}return a+(d||" …")}}angular.module("jobhop",["ionic","angular-google-gapi","ngCordova","ngStorage","uiGmapgoogle-maps","nl2br","jobhop.controllers","jobhop.directives","jobhop.services","jobhop.filters","jobhop.views","chart.js"]).config(Config).run(Run),Config.$inject=["$stateProvider","$urlRouterProvider","$ionicConfigProvider"],Run.$inject=["$rootScope","$ionicPlatform","GApi","GAuth","JobHopAPI","$window","$state"],angular.module("jobhop.controllers",[]),angular.module("jobhop.controllers").controller("MainController",MainController),MainController.$inject=["$location","$scope","JobHopAPI","$ionicModal","$ionicLoading","$state","$cordovaEmailComposer","$cordovaDialogs","$cordovaToast","$cordovaSocialSharing","$cordovaInAppBrowser","$cordovaFacebook","$localStorage","$stateParams","$timeout","$cordovaCapture"],angular.module("jobhop.controllers").controller("JobsUserController",JobsUserController),JobsUserController.$inject=["$rootScope","$scope","JobHopAPI","$cordovaGeolocation","$ionicPlatform","$ionicLoading","$state","$timeout"],angular.module("jobhop.controllers").controller("JobsSearchController",JobsSearchController),JobsSearchController.$inject=["$scope","JobHopAPI","$cordovaGeolocation","$ionicPlatform","$state","$timeout"],angular.module("jobhop.controllers").controller("ProductsController",ProductsController),ProductsController.$inject=["$rootScope","$http","$cordovaSocialSharing","$filter","$ionicPopup","$scope","$ionicModal","JobHopAPI","$cordovaGeolocation","$ionicPlatform","$ionicLoading"],angular.module("jobhop.controllers").controller("JobController",JobController),JobController.$inject=["$scope","JobHopAPI","$cordovaSocialSharing","$cordovaDialogs","$cordovaToast","$ionicLoading","$stateParams","$state"],angular.module("jobhop.controllers").controller("JobEmployerController",JobEmployerController),JobEmployerController.$inject=["$scope","JobHopAPI","$cordovaToast","$ionicLoading","$stateParams"],angular.module("jobhop.controllers").controller("UserProfileController",UserProfileController),UserProfileController.$inject=["$scope","$sce"],angular.module("jobhop.controllers").controller("UserProfileEditController",UserProfileEditController),UserProfileEditController.$inject=["$scope","JobHopAPI","$cordovaCamera","$cordovaDialogs","$cordovaToast","$ionicLoading","$state"],angular.module("jobhop.controllers").controller("RegisterController",RegisterController),RegisterController.$inject=["$scope","JobHopAPI","$cordovaCamera","$cordovaFacebook","$cordovaDialogs","$ionicLoading","$stateParams","$ionicHistory","$state","$timeout"],angular.module("jobhop.directives",[]),angular.module("jobhop.directives").directive("jobBlock",jobBlock),jobBlock.$inject=[],angular.module("jobhop.directives").directive("hideTabs",hideTabs),hideTabs.$inject=[],angular.module("jobhop.services",[]),angular.module("jobhop.services").factory("JobHopAPI",JobHopAPI).constant("JobsPerPage",15),JobHopAPI.$inject=["GApi","JobsPerPage","$localStorage","$cordovaFacebook","$cordovaFileTransfer","$q","$window"],angular.module("jobhop.filters",[]),angular.module("jobhop.filters").filter("cut",cut),cut.$inject=[],angular.module("jobhop.views",[]),angular.module("jobhop.views").run(["$templateCache",function(a){"use strict";a.put("www/views/about.html",'<ion-view>\r\n    <ion-content>\r\n        <div class="bordered">\r\n            <h2 style="padding: 0 16px;">אודות החברה</h2>\r\n            <p>לורם איפסום או בקיצור ליפסום (בלטינית: lorem ipsum) הוא מלל מקובל וחסר משמעות המשמש "ממלא מקום" בעת עריכה, בתחום הדפוס, ההדפסה והפרסום.</p>\r\n            <p>הטקסט משמש כלי לייצוג דפוס שאמור להתווסף למוצר הפרסום בעתיד. המדובר במלל ארוך במיוחד שניתן לבדוק עמו גופנים, וכן התאמת המלל לעמודים המעוצבים ובדיקת סוגי וגדלי גופן והתאמתם למוצר הסופי.</p>\r\n            <p>בשל הדמיון של המילים בלורם איפסום ללטינית קלאסית, רבים חושבים שיש משמעות לטקסט, אולם לא נועדה להיות לו כל משמעות. המטרה היא רק "תפיסת מקום" על ידי מלל חסר משמעות (ראו דוגמה בהמשך).</p>\r\n        </div>\r\n    </ion-content>\r\n</ion-view>\r\n'),a.put("www/views/chart.html",'<ion-view>\r\n    <ion-content>\r\n        <div class="bordered">\r\n            <h2 style="padding: 0 16px;">אודות החברה</h2>\r\n            <p>לורם איפסום או בקיצור ליפסום (בלטינית: lorem ipsum) הוא מלל מקובל וחסר משמעות המשמש "ממלא מקום" בעת עריכה, בתחום הדפוס, ההדפסה והפרסום.</p>\r\n            <p>הטקסט משמש כלי לייצוג דפוס שאמור להתווסף למוצר הפרסום בעתיד. המדובר במלל ארוך במיוחד שניתן לבדוק עמו גופנים, וכן התאמת המלל לעמודים המעוצבים ובדיקת סוגי וגדלי גופן והתאמתם למוצר הסופי.</p>\r\n            <p>בשל הדמיון של המילים בלורם איפסום ללטינית קלאסית, רבים חושבים שיש משמעות לטקסט, אולם לא נועדה להיות לו כל משמעות. המטרה היא רק "תפיסת מקום" על ידי מלל חסר משמעות (ראו דוגמה בהמשך).</p>\r\n        </div>\r\n    </ion-content>\r\n</ion-view>\r\n'),a.put("www/views/contact.html",'<ion-view style="text-align: center">\r\n    <ion-content>\r\n        <h2>צור קשר</h2>\r\n        <div class="bordered contact">\r\n            <img src="/img/tozeret.png" />\r\n            <p style="font-size: 16px">\r\n    חברת השוק הסיטונאי בע"מ<br />\r\n                אפעל 35, פתח תקווה\r\n            </p>\r\n            <p>מייל: <span style="font-size:13px; white-space: nowrap">contact@israeli-market.org.il</span>\r\n            <br />\r\n            אתר: <span style="font-size:13px; white-space: nowrap">www.israeli-market.gov.il</span></p>\r\n        </div>\r\n    </ion-content>\r\n</ion-view>'),a.put("www/views/help.html",'<ion-view>\r\n    <ion-content>\r\n        <div class="bordered">\r\n            <h2 style="padding: 0 16px;">עזרה</h2>\r\n            <p>לורם איפסום או בקיצור ליפסום (בלטינית: lorem ipsum) הוא מלל מקובל וחסר משמעות המשמש "ממלא מקום" בעת עריכה, בתחום הדפוס, ההדפסה והפרסום.</p>\r\n            <p>הטקסט משמש כלי לייצוג דפוס שאמור להתווסף למוצר הפרסום בעתיד. המדובר במלל ארוך במיוחד שניתן לבדוק עמו גופנים, וכן התאמת המלל לעמודים המעוצבים ובדיקת סוגי וגדלי גופן והתאמתם למוצר הסופי.</p>\r\n            <p>בשל הדמיון של המילים בלורם איפסום ללטינית קלאסית, רבים חושבים שיש משמעות לטקסט, אולם לא נועדה להיות לו כל משמעות. המטרה היא רק "תפיסת מקום" על ידי מלל חסר משמעות (ראו דוגמה בהמשך).</p>\r\n        </div>\r\n    </ion-content>\r\n</ion-view>\r\n'),a.put("www/views/list/date-popup.html",'<div>\r\n    <img src="img/icon/x.png" class="close" ng-click="closeDatePopup()" />\r\n    <div class="row">\r\n        <div class="col">\r\n            <span class="title">תאריך</span>\r\n            <input ng-model="dateFilter" type="date" />\r\n        </div>\r\n    </div>\r\n    <div class="popup-buttons">\r\n        <button class="button button-positive button-block" ng-click="setDate(dateFilter)">שמור</button>\r\n    </div>\r\n</div>\r\n'),
a.put("www/views/list/details-popup.html",'<div>\r\n    <img src="img/icon/x.png" class="close" ng-click="closeDetailsPopup()" />\r\n    <div class="row">\r\n        <div class="col">\r\n            <span class="title">פרטים</span>\r\n            <label>\r\n                <input ng-model="listDetailsInput" type="radio" name="list-details" value="price" ng-checked="listDetails == \'price\'">\r\n                <span class="style"></span>\r\n                מחיר יומי\r\n            </label>\r\n            <label>\r\n                <input ng-model="listDetailsInput" type="radio" name="list-details" value="avgPrice" ng-checked="listDetails == \'avgPrice\'">\r\n                <span class="style"></span>\r\n                מחיר ממוצע\r\n            </label>\r\n            <label>\r\n                <input ng-model="listDetailsInput" type="radio" name="list-details" value="percentChange" ng-checked="listDetails == \'percentChange\'">\r\n                <span class="style"></span>\r\n                אחוז שינוי במחיר\r\n            </label>\r\n        </div>\r\n    </div>\r\n    <div class="popup-buttons">\r\n        <button class="button button-positive button-block" ng-click="setListDetails(listDetailsInput)">שמור</button>\r\n    </div>\r\n</div>\r\n'),a.put("www/views/list/filter-popup.html",'<div>\r\n    <img src="img/icon/x.png" class="close" ng-click="closeFilterPopup()" />\r\n    <div class="row">\r\n        <div class="col">\r\n            <span class="title">סינון</span>\r\n            <label>\r\n                <input ng-model="typeFilter" value="" type="radio" name="search-by-type" checked="checked">\r\n                <span class="style"></span>\r\n                ירקות ופירות\r\n            </label>\r\n            <label>\r\n                <input ng-model="typeFilter" value="VEG" type="radio" name="search-by-type">\r\n                <span class="style"></span>\r\n                ירקות בלבד\r\n            </label>\r\n            <label>\r\n                <input ng-model="typeFilter" value="FRUITS" type="radio" name="search-by-type">\r\n                <span class="style"></span>\r\n                פירות בלבד\r\n            </label>\r\n        </div>\r\n    </div>\r\n    <hr>\r\n    <div class="row">\r\n        <div class="col">\r\n            <span class="title">מיון</span>\r\n            <label>\r\n                <input ng-model="orderFilter" value="DAILY_CHANGE" type="radio" name="order-by" checked="checked">\r\n                <span class="style"></span>\r\n                אחוז שינוי יומי\r\n            </label>\r\n            <label>\r\n                <input ng-model="orderFilter" value="ABC" type="radio" name="order-by">\r\n                <span class="style"></span>\r\n                א\'-ב\'\r\n            </label>\r\n            <label>\r\n                <input ng-model="orderFilter" value="PRICE" type="radio" name="order-by">\r\n                <span class="style"></span>\r\n                מחיר\r\n            </label>\r\n        </div>\r\n    </div>\r\n    <div class="popup-buttons">\r\n        <button class="button button-positive button-block" ng-click="setFilters(orderFilter, typeFilter)">שמור</button>\r\n    </div>\r\n</div>\r\n'),a.put("www/views/list/push-popup.html",'<div>\r\n    <img src="img/icon/x.png" class="close" ng-click="closePushNotificationPopup()" />\r\n    <div class="row">\r\n        <div class="col">\r\n            <span class="title">הודעת פוש</span>\r\n            <p>\r\n                <label>\r\n                    <input ng-model="pushNotificationEnabled" type="checkbox" style="width:auto;" />\r\n                    <span class="style"></span>\r\n                </label>\r\n                אפשר הודעות פוש עבור המוצר\r\n                <b>{{itemTitleForPushNotificationPopup}}</b>\r\n                <br />\r\n                כאשר המחיר משתנה ב\r\n                <select ng-model="pushNotificationPercent" id="push-notification-percent">\r\n                    <option value="10">10%</option>\r\n                    <option value="20">20%</option>\r\n                    <option value="30">30%</option>\r\n                    <option value="40">40%</option>\r\n                    <option value="50">50%</option>\r\n                    <option value="60">60%</option>\r\n                    <option value="70">70%</option>\r\n                    <option value="80">80%</option>\r\n                    <option value="90">90%</option>\r\n                </select>\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <div class="popup-buttons">\r\n        <button class="button button-positive button-block" ng-click="setPushNotificationPercent(itemForPushNotificationPopup, pushNotificationEnabled, pushNotificationPercent)">שמור</button>\r\n    </div>\r\n</div>\r\n'),a.put("www/views/products.html",'<ion-view>\n    <ion-content scroll="true" padding="false" class="has-footer">\n        <div class="row top-tabs">\n            <div class="col"><img src="/img/icon/basket.png"><br />סל מוצרים</div>\n            <div class="col" ng-click="showDetailsPopup()"><img src="/img/icon/details.png"><br />פרטים</div>\n            <div class="col" ng-click="showFilterPopup()"><img src="/img/icon/filter.png"><br />סינון ומיון</div>\n        </div>\n        <div class="list-container" ng-class="viewClassName">\n            <div class="fruit-wrapper" ng-repeat="item in items">\n                <div class="fruit-item">\n                    <div class="image">\n                        <img src="http://localhost:8100/img/logo.png" ng-click="itemClicked(item)">\n                    </div>\n                    <h4>{{item.name}}</h4>\n                    <div class="price">\n                        <table ng-show="listDetails == \'price\'">\n                            <tr><td>מחיר סוג א\'</td><td>{{primeQualityPrice(item)}} ש"ח</td></tr>\n                            <tr><td>מחיר מובחר</td><td>{{topQualityPrice(item)}} ש"ח</td></tr>\n                        </table>\n                        <table ng-show="listDetails == \'avgPrice\'">\n                            <tr><td>מחיר ממוצע סוג א\'</td><td>{{primeQualityAvgPrice(item)}} ש"ח</td></tr>\n                            <tr><td>מחיר ממוצע מובחר</td><td>{{topQualityAvgPrice(item)}} ש"ח</td></tr>\n                        </table>\n                        <table ng-show="listDetails == \'percentChange\'">\n                            <tr><td>אחוז שינוי סוג א\'</td><td>{{primeQualityPercentChange(item)}}%</td></tr>\n                            <tr><td>אחוז שינוי מובחר</td><td>{{topQualityPercentChange(item)}}%</td></tr>\n                        </table>\n                    </div>\n                    <div class="buttons">\n                        <span class="push-percent" ng-click="showPushNotificationPopup(item)">{{item.percent}}<small ng-if="item.percent">%</small></span>\n                        <img src="/img/item-push.png" style="float:right;" ng-click="showPushNotificationPopup(item)">\n                        <img src="/img/item-share.png" style="float:left;" ng-click="shareProduct(item)">\n                    </div>\n                </div>\n            </div>\n        </div>\n    </ion-content>\n    <ion-infinite-scroll\n            ng-if="moreDataCanBeLoaded()"\n            on-infinite="loadMore()"\n            distance="10%">\n    </ion-infinite-scroll>\n</ion-view>'),a.put("www/views/tabs.html",'<ion-view>\r\n    <ion-nav-view name="content"></ion-nav-view>\r\n    <ion-tabs class="tabs-balanced tabs-icon-top" ng-class="hideTabs">\r\n        <ion-tab title="מחיר סיטונאי" icon-on="buyer" icon-off="buyer"  ui-sref="withTabs.productsWholesale" on-select="setUserType(\'wholesale\')"></ion-tab>\r\n        <ion-tab title="מחיר חקלאי" icon-on="farmer" icon-off="farmer"  ui-sref="withTabs.productsAgriculture" on-select="setUserType(\'agriculture\')"></ion-tab>\r\n        <ion-tab title="גרפים" icon-on="graph" icon-off="graph" ui-sref="withTabs.chart"></ion-tab>\r\n    </ion-tabs>\r\n</ion-view>\r\n')}]);